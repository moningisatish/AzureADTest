List<EdtcsrpolicyDTO> edtcsrpolicyList = records.stream().map(edtcsrpolicy -> {
    edtcsrpolicy.setTimezone(request.getTimeZone());
    EdtcsrpolicyDTO edtcsrpolicyDTO = mapper.toDto(edtcsrpolicy);

    // Set Edicompno if Edtcsrclientcompany is not null
    if (edtcsrpolicy.getEdtcsrclientcompany() != null) {
        edtcsrpolicyDTO.setEdicompno(edtcsrpolicy.getEdtcsrclientcompany().getClientcompanyidhsbassigned());
    }

    // Map Edtcsrins list
    List<EdtcsrinDTO> insuranceList = Optional.ofNullable(edtcsrpolicy.getEdtcsrins())
        .orElse(Collections.emptyList())
        .stream()
        .map(edtcsrInsMapper::toDTO)
        .collect(Collectors.toList());
    edtcsrpolicyDTO.setEdtcsrins(insuranceList);

    // Map Edtcsrlocs list
    List<EdtcsrlocDTO> edtcsrlocDTOList = Optional.ofNullable(edtcsrpolicy.getEdtcsrlocs())
        .orElse(Collections.emptyList())
        .stream()
        .map(edtcsrlocMapper::toDTO)
        .collect(Collectors.toList());
    edtcsrpolicyDTO.setEdtcsrlocs(edtcsrlocDTOList);

    // Map Edtcsrpvlines list
    List<EdtcsrpvlineDTO> edtcsrpvlineDTOList = Optional.ofNullable(edtcsrpolicy.getEdtcsrpvlines())
        .orElse(Collections.emptyList())
        .stream()
        .map(edtcsrpvlineMapper::toDTO)
        .collect(Collectors.toList());
    edtcsrpolicyDTO.setEdtcsrpvlines(edtcsrpvlineDTOList);

    return edtcsrpolicyDTO;
}).collect(Collectors.toList());
